<div class="container mt-4">
  <h2 *ngIf="!employeeId">All Workflows</h2>
  <h2 *ngIf="employeeId">Workflows for Employee: <u>{{ employeeId }}</u></h2>

  <div *ngIf="loading" class="alert alert-info">Loading workflows...</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <table *ngIf="!loading && workflows.length > 0" class="table table-striped mt-3">
    <thead>
      <tr>
        <th>Type</th>
        <th>Details</th>
        <th>Status</th>
        <th style="width: 140px">Actions</th>
        <th>Created At</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let wf of workflows" [ngClass]="getRowClass(wf.status)">
        <td>{{ wf.type }}</td>
        <td>{{ wf.details }}</td>
        <!-- Apply titlecase pipe -->
        <td >{{ wf.status | titlecase }}</td>
        <td>
          <div class="d-flex align-items-center gap-2">
            <select
              #sel
              class="form-select"
              [value]="wf.status"
              (change)="onStatusChange(wf, sel.value)"
              [disabled]="isUpdating(wf.id)"
            >
              <!-- Also titlecase in dropdown -->
              <option *ngFor="let s of statuses" [value]="s">{{ s | titlecase }}</option>
            </select>

            <div *ngIf="isUpdating(wf.id)" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></div>
          </div>
        </td>
        <td>{{ wf.createdAt }}</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading && workflows.length === 0" class="alert alert-warning">
    No workflows found.
  </div>
</div>
