<div class="container mt-4">
  <h3>Edit Request</h3>

  <div *ngIf="loading" class="alert alert-info">Loadingâ€¦</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <form [formGroup]="form" (ngSubmit)="save()" *ngIf="!loading">
    <!-- Type -->
    <div class="mb-3">
      <label class="form-label" for="typeSelect">Type</label>
      <select class="form-select" formControlName="type" id="typeSelect" title="Type">
        <option value="">-- Select Type --</option>
        <option *ngFor="let t of allowedTypes" [value]="t">
          {{ t | titlecase }}
        </option>
      </select>
    </div>

    <!-- Employee -->
    <div class="mb-3">
      <label class="form-label">Employee</label>
      <select class="form-select" formControlName="accountId" title="Employee">
        <option value="">-- Select Employee --</option>
        <option *ngFor="let e of employees" [value]="e.accountId">
          {{ e.displayName }}
        </option>
      </select>
    </div>

    <!-- Items -->
    <div class="mb-3">
      <label class="form-label">Items</label>
      <div formArrayName="items">
        <div *ngFor="let item of items.controls; let i = index" [formGroupName]="i" class="row g-2 mb-2">
          <div class="col">
            <input class="form-control" formControlName="name" placeholder="Name" />
          </div>
          <div class="col-3">
            <input type="number" class="form-control" formControlName="quantity" min="1" placeholder="Quantity" title="Quantity" />
          </div>
          <div class="col-auto">
            <button type="button" class="btn btn-danger" (click)="removeItem(i)">Remove</button>
          </div>
        </div>
      </div>
      <div>
      <button type="button" class="btn btn-secondary mt-2 me-2" (click)="addItem()">Add Item</button>
      <button type="button" class="btn btn-danger mt-2 me-2" (click)="delete()" [disabled]="submitting">
        Delete
      </button>
    </div>
</div>
    <!-- Actions -->
    <div class="mt-3">
      <button type="submit" class="btn btn-primary me-2" [disabled]="submitting">
        <span *ngIf="submitting" class="spinner-border spinner-border-sm me-1"></span>
        Update
      </button>
      <button type="button" class="btn btn-secondary me-2" (click)="cancel()">Cancel</button>
      
    </div>
  </form>
</div>
